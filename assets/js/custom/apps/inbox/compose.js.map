{"version":3,"file":"js/custom/apps/inbox/compose.js","mappings":";;;;;;AAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,yFAAyF;AACvG,cAAc,+EAA+E;AAC7F,cAAc,qFAAqF;AACnG,cAAc,wFAAwF;AACtG,cAAc,gGAAgG;AAC9G,cAAc,yFAAyF;AACvG,cAAc,uFAAuF;AACrG,cAAc;AACd;AACA;AACA;AACA;AACA,8BAA8B,iCAAiC;AAC/D;AACA;AACA;AACA,iCAAiC,8BAA8B,EAAE,mCAAmC;AACpG,0BAA0B,4BAA4B;AACtD;AACA;AACA;AACA,oHAAoH,QAAQ,QAAQ,eAAe;AACnJ;AACA,yDAAyD,aAAa;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,8EAA8E,mCAAmC;AACjH;AACA;AACA;AACA,sBAAsB;AACtB;AACA,yHAAyH,QAAQ,QAAQ,eAAe;AACxJ;AACA;AACA;AACA;AACA,kCAAkC,aAAa;AAC/C,gCAAgC,cAAc;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://keenthemes/../src/js/custom/apps/inbox/compose.js"],"sourcesContent":["\"use strict\";\r\n\r\n// Class definition\r\nvar KTAppInboxCompose = function () {\r\n    // Private functions\r\n    // Init reply form\r\n    const initForm = () => {\r\n        // Set variables\r\n        const form = document.querySelector('#kt_inbox_compose_form');\r\n        const allTagify = form.querySelectorAll('[data-kt-inbox-form=\"tagify\"]');\r\n\r\n        // Handle CC and BCC\r\n        handleCCandBCC(form);\r\n\r\n        // Handle submit form\r\n        handleSubmit(form);\r\n\r\n        // Init tagify\r\n        allTagify.forEach(tagify => {\r\n            initTagify(tagify);\r\n        });\r\n\r\n        // Init quill editor\r\n        initQuill(form);\r\n\r\n        // Init dropzone\r\n        initDropzone(form);\r\n    }\r\n\r\n    // Handle CC and BCC toggle\r\n    const handleCCandBCC = (el) => {\r\n        // Get elements\r\n        const ccElement = el.querySelector('[data-kt-inbox-form=\"cc\"]');\r\n        const ccButton = el.querySelector('[data-kt-inbox-form=\"cc_button\"]');\r\n        const ccClose = el.querySelector('[data-kt-inbox-form=\"cc_close\"]');\r\n        const bccElement = el.querySelector('[data-kt-inbox-form=\"bcc\"]');\r\n        const bccButton = el.querySelector('[data-kt-inbox-form=\"bcc_button\"]');\r\n        const bccClose = el.querySelector('[data-kt-inbox-form=\"bcc_close\"]');\r\n\r\n        // Handle CC button click\r\n        ccButton.addEventListener('click', e => {\r\n            e.preventDefault();\r\n\r\n            ccElement.classList.remove('d-none');\r\n            ccElement.classList.add('d-flex');\r\n        });\r\n\r\n        // Handle CC close button click\r\n        ccClose.addEventListener('click', e => {\r\n            e.preventDefault();\r\n\r\n            ccElement.classList.add('d-none');\r\n            ccElement.classList.remove('d-flex');\r\n        });\r\n\r\n        // Handle BCC button click\r\n        bccButton.addEventListener('click', e => {\r\n            e.preventDefault();\r\n\r\n            bccElement.classList.remove('d-none');\r\n            bccElement.classList.add('d-flex');\r\n        });\r\n\r\n        // Handle CC close button click\r\n        bccClose.addEventListener('click', e => {\r\n            e.preventDefault();\r\n\r\n            bccElement.classList.add('d-none');\r\n            bccElement.classList.remove('d-flex');\r\n        });\r\n    }\r\n\r\n    // Handle submit form\r\n    const handleSubmit = (el) => {\r\n        const submitButton = el.querySelector('[data-kt-inbox-form=\"send\"]');\r\n\r\n        // Handle button click event\r\n        submitButton.addEventListener(\"click\", function () {\r\n            // Activate indicator\r\n            submitButton.setAttribute(\"data-kt-indicator\", \"on\");\r\n\r\n            // Disable indicator after 3 seconds\r\n            setTimeout(function () {\r\n                submitButton.removeAttribute(\"data-kt-indicator\");\r\n            }, 3000);\r\n        });\r\n    }\r\n\r\n    // Init tagify \r\n    const initTagify = (el) => {\r\n        var inputElm = el;\r\n\r\n        const usersList = [\r\n            { value: 1, name: 'Emma Smith', avatar: 'avatars/300-6.jpg', email: 'e.smith@kpmg.com.au' },\r\n            { value: 2, name: 'Max Smith', avatar: 'avatars/300-1.jpg', email: 'max@kt.com' },\r\n            { value: 3, name: 'Sean Bean', avatar: 'avatars/300-5.jpg', email: 'sean@dellito.com' },\r\n            { value: 4, name: 'Brian Cox', avatar: 'avatars/300-25.jpg', email: 'brian@exchange.com' },\r\n            { value: 5, name: 'Francis Mitcham', avatar: 'avatars/300-9.jpg', email: 'f.mitcham@kpmg.com.au' },\r\n            { value: 6, name: 'Dan Wilson', avatar: 'avatars/300-23.jpg', email: 'dam@consilting.com' },\r\n            { value: 7, name: 'Ana Crown', avatar: 'avatars/300-12.jpg', email: 'ana.cf@limtel.com' },\r\n            { value: 8, name: 'John Miller', avatar: 'avatars/300-13.jpg', email: 'miller@mapple.com' }\r\n        ];\r\n\r\n        function tagTemplate(tagData) {\r\n            return `\r\n                <tag title=\"${(tagData.title || tagData.email)}\"\r\n                        contenteditable='false'\r\n                        spellcheck='false'\r\n                        tabIndex=\"-1\"\r\n                        class=\"${this.settings.classNames.tag} ${tagData.class ? tagData.class : \"\"}\"\r\n                        ${this.getAttributes(tagData)}>\r\n                    <x title='' class='tagify__tag__removeBtn' role='button' aria-label='remove tag'></x>\r\n                    <div class=\"d-flex align-items-center\">\r\n                        <div class='tagify__tag__avatar-wrap ps-0'>\r\n                            <img onerror=\"this.style.visibility='hidden'\" class=\"rounded-circle w-25px me-2\" src=\"${hostUrl}media/${tagData.avatar}\">\r\n                        </div>\r\n                        <span class='tagify__tag-text'>${tagData.name}</span>\r\n                    </div>\r\n                </tag>\r\n            `\r\n        }\r\n\r\n        function suggestionItemTemplate(tagData) {\r\n            return `\r\n                <div ${this.getAttributes(tagData)}\r\n                    class='tagify__dropdown__item d-flex align-items-center ${tagData.class ? tagData.class : \"\"}'\r\n                    tabindex=\"0\"\r\n                    role=\"option\">\r\n\r\n                    ${tagData.avatar ? `\r\n                            <div class='tagify__dropdown__item__avatar-wrap me-2'>\r\n                                <img onerror=\"this.style.visibility='hidden'\"  class=\"rounded-circle w-50px me-2\" src=\"${hostUrl}media/${tagData.avatar}\">\r\n                            </div>` : ''\r\n                }\r\n\r\n                    <div class=\"d-flex flex-column\">\r\n                        <strong>${tagData.name}</strong>\r\n                        <span>${tagData.email}</span>\r\n                    </div>\r\n                </div>\r\n            `\r\n        }\r\n\r\n        // initialize Tagify on the above input node reference\r\n        var tagify = new Tagify(inputElm, {\r\n            tagTextProp: 'name', // very important since a custom template is used with this property as text. allows typing a \"value\" or a \"name\" to match input with whitelist\r\n            enforceWhitelist: true,\r\n            skipInvalid: true, // do not remporarily add invalid tags\r\n            dropdown: {\r\n                closeOnSelect: false,\r\n                enabled: 0,\r\n                classname: 'users-list',\r\n                searchKeys: ['name', 'email']  // very important to set by which keys to search for suggesttions when typing\r\n            },\r\n            templates: {\r\n                tag: tagTemplate,\r\n                dropdownItem: suggestionItemTemplate\r\n            },\r\n            whitelist: usersList\r\n        })\r\n\r\n        tagify.on('dropdown:show dropdown:updated', onDropdownShow)\r\n        tagify.on('dropdown:select', onSelectSuggestion)\r\n\r\n        var addAllSuggestionsElm;\r\n\r\n        function onDropdownShow(e) {\r\n            var dropdownContentElm = e.detail.tagify.DOM.dropdown.content;\r\n\r\n            if (tagify.suggestedListItems.length > 1) {\r\n                addAllSuggestionsElm = getAddAllSuggestionsElm();\r\n\r\n                // insert \"addAllSuggestionsElm\" as the first element in the suggestions list\r\n                dropdownContentElm.insertBefore(addAllSuggestionsElm, dropdownContentElm.firstChild)\r\n            }\r\n        }\r\n\r\n        function onSelectSuggestion(e) {\r\n            if (e.detail.elm == addAllSuggestionsElm)\r\n                tagify.dropdown.selectAll.call(tagify);\r\n        }\r\n\r\n        // create a \"add all\" custom suggestion element every time the dropdown changes\r\n        function getAddAllSuggestionsElm() {\r\n            // suggestions items should be based on \"dropdownItem\" template\r\n            return tagify.parseTemplate('dropdownItem', [{\r\n                class: \"addAll\",\r\n                name: \"Add all\",\r\n                email: tagify.settings.whitelist.reduce(function (remainingSuggestions, item) {\r\n                    return tagify.isTagDuplicate(item.value) ? remainingSuggestions : remainingSuggestions + 1\r\n                }, 0) + \" Members\"\r\n            }]\r\n            )\r\n        }\r\n    }\r\n\r\n    // Init quill editor \r\n    const initQuill = (el) => {\r\n        var quill = new Quill('#kt_inbox_form_editor', {\r\n            modules: {\r\n                toolbar: [\r\n                    [{\r\n                        header: [1, 2, false]\r\n                    }],\r\n                    ['bold', 'italic', 'underline'],\r\n                    ['image', 'code-block']\r\n                ]\r\n            },\r\n            placeholder: 'Type your text here...',\r\n            theme: 'snow' // or 'bubble'\r\n        });\r\n\r\n        // Customize editor\r\n        const toolbar = el.querySelector('.ql-toolbar');\r\n\r\n        if (toolbar) {\r\n            const classes = ['px-5', 'border-top-0', 'border-start-0', 'border-end-0'];\r\n            toolbar.classList.add(...classes);\r\n        }\r\n    }\r\n\r\n    // Init dropzone\r\n    const initDropzone = (el) => {\r\n        // set the dropzone container id\r\n        const id = '[data-kt-inbox-form=\"dropzone\"]';\r\n        const dropzone = el.querySelector(id);\r\n        const uploadButton = el.querySelector('[data-kt-inbox-form=\"dropzone_upload\"]');\r\n\r\n        // set the preview element template\r\n        var previewNode = dropzone.querySelector(\".dropzone-item\");\r\n        previewNode.id = \"\";\r\n        var previewTemplate = previewNode.parentNode.innerHTML;\r\n        previewNode.parentNode.removeChild(previewNode);\r\n\r\n        var myDropzone = new Dropzone(id, { // Make the whole body a dropzone\r\n            url: \"https://preview.keenthemes.com/api/dropzone/void.php\", // Set the url for your upload script location\r\n            parallelUploads: 20,\r\n            maxFilesize: 1, // Max filesize in MB\r\n            previewTemplate: previewTemplate,\r\n            previewsContainer: id + \" .dropzone-items\", // Define the container to display the previews\r\n            clickable: uploadButton // Define the element that should be used as click trigger to select files.\r\n        });\r\n\r\n\r\n        myDropzone.on(\"addedfile\", function (file) {\r\n            // Hookup the start button\r\n            const dropzoneItems = dropzone.querySelectorAll('.dropzone-item');\r\n            dropzoneItems.forEach(dropzoneItem => {\r\n                dropzoneItem.style.display = '';\r\n            });\r\n        });\r\n\r\n        // Update the total progress bar\r\n        myDropzone.on(\"totaluploadprogress\", function (progress) {\r\n            const progressBars = dropzone.querySelectorAll('.progress-bar');\r\n            progressBars.forEach(progressBar => {\r\n                progressBar.style.width = progress + \"%\";\r\n            });\r\n        });\r\n\r\n        myDropzone.on(\"sending\", function (file) {\r\n            // Show the total progress bar when upload starts\r\n            const progressBars = dropzone.querySelectorAll('.progress-bar');\r\n            progressBars.forEach(progressBar => {\r\n                progressBar.style.opacity = \"1\";\r\n            });\r\n        });\r\n\r\n        // Hide the total progress bar when nothing\"s uploading anymore\r\n        myDropzone.on(\"complete\", function (progress) {\r\n            const progressBars = dropzone.querySelectorAll('.dz-complete');\r\n\r\n            setTimeout(function () {\r\n                progressBars.forEach(progressBar => {\r\n                    progressBar.querySelector('.progress-bar').style.opacity = \"0\";\r\n                    progressBar.querySelector('.progress').style.opacity = \"0\";\r\n                });\r\n            }, 300);\r\n        });\r\n    }\r\n\r\n\r\n    // Public methods\r\n    return {\r\n        init: function () {\r\n            initForm();\r\n        }\r\n    };\r\n}();\r\n\r\n// On document ready\r\nKTUtil.onDOMContentLoaded(function () {\r\n    KTAppInboxCompose.init();\r\n});\r\n"],"names":[],"sourceRoot":""}